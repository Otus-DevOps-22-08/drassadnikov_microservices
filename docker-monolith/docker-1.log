[root@redos redos]# docker images
REPOSITORY                 TAG       IMAGE ID       CREATED          SIZE
yourname/ubuntu-tmp-file   latest    be6d19673ead   22 seconds ago   63.1MB
nginx                      latest    3f8a00f137a0   2 weeks ago      142MB
ubuntu                     18.04     5d2df19066ac   4 weeks ago      63.1MB
hello-world                latest    feb5d9fea6a5   17 months ago    13.3kB
---------------------------
[root@redos redos]# docker ps
CONTAINER ID   IMAGE          COMMAND                  CREATED          STATUS          PORTS     NAMES
c4bec051c426   nginx:latest   "/docker-entrypoint.…"   10 minutes ago   Up 10 minutes   80/tcp    strange_banach
5aeebddc380a   ubuntu:18.04   "/bin/bash"              23 minutes ago   Up 12 minutes             vigorous_ardinghelli


docker inspect 5aeebddc380a
[root@redos redos]# docker inspect 5aeebddc380a
[
    {
        "Id": "5aeebddc380ae2079b55e3c92e6eb95ee47068834284b7225048a8ccc16de9db",
        "Created": "2023-02-27T19:00:35.475471603Z",
        "Path": "/bin/bash",
        "Args": [],
        "State": {
            "Status": "running",
            "Running": true,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 5270,
            "ExitCode": 0,
            "Error": "",
            "StartedAt": "2023-02-27T19:11:51.476169999Z",
            "FinishedAt": "2023-02-27T19:08:27.473385724Z"
        },
        "Image": "sha256:5d2df19066aca89df8e5317544a1cb599dc657830184762ff6fdefaaf708db65",
        "ResolvConfPath": "/var/lib/docker/containers/5aeebddc380ae2079b55e3c92e6eb95ee47068834284b7225048a8ccc16de9db/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/5aeebddc380ae2079b55e3c92e6eb95ee47068834284b7225048a8ccc16de9db/hostname",
        "HostsPath": "/var/lib/docker/containers/5aeebddc380ae2079b55e3c92e6eb95ee47068834284b7225048a8ccc16de9db/hosts",
        "LogPath": "/var/lib/docker/containers/5aeebddc380ae2079b55e3c92e6eb95ee47068834284b7225048a8ccc16de9db/5aeebddc380ae2079b55e3c92e6eb95ee47068834284b7225048a8ccc16de9db-json.log",
        "Name": "/vigorous_ardinghelli",
        "RestartCount": 0,
        "Driver": "overlay2",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": null,
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "default",
            "PortBindings": {},
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": [],
            "DnsOptions": [],
            "DnsSearch": [],
            "ExtraHosts": null,
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": false,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": null,
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "ConsoleSize": [
                0,
                0
            ],
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": [],
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": [],
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "KernelMemory": 0,
            "KernelMemoryTCP": 0,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": [
                "/proc/asound",
                "/proc/acpi",
                "/proc/kcore",
                "/proc/keys",
                "/proc/latency_stats",
                "/proc/timer_list",
                "/proc/timer_stats",
                "/proc/sched_debug",
                "/proc/scsi",
                "/sys/firmware"
            ],
            "ReadonlyPaths": [
                "/proc/bus",
                "/proc/fs",
                "/proc/irq",
                "/proc/sys",
                "/proc/sysrq-trigger"
            ]
        },
        "GraphDriver": {
            "Data": {
                "LowerDir": "/var/lib/docker/overlay2/783d6ea8bfdaa65b77c29c33ded5e84cba0c304c79e70f0fba6dfa4001bba70f-init/diff:/var/lib/docker/overlay2/a33fde35942647bc7e1a9398eeccbfa4653461c9045a5093be65775f4a5bb6d1/diff",
                "MergedDir": "/var/lib/docker/overlay2/783d6ea8bfdaa65b77c29c33ded5e84cba0c304c79e70f0fba6dfa4001bba70f/merged",
                "UpperDir": "/var/lib/docker/overlay2/783d6ea8bfdaa65b77c29c33ded5e84cba0c304c79e70f0fba6dfa4001bba70f/diff",
                "WorkDir": "/var/lib/docker/overlay2/783d6ea8bfdaa65b77c29c33ded5e84cba0c304c79e70f0fba6dfa4001bba70f/work"
            },
            "Name": "overlay2"
        },
        "Mounts": [],
        "Config": {
            "Hostname": "5aeebddc380a",
            "Domainname": "",
            "User": "",
            "AttachStdin": true,
            "AttachStdout": true,
            "AttachStderr": true,
            "Tty": true,
            "OpenStdin": true,
            "StdinOnce": true,
            "Env": [
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
            ],
            "Cmd": [
                "/bin/bash"
            ],
            "Image": "ubuntu:18.04",
            "Volumes": null,
            "WorkingDir": "",
            "Entrypoint": null,
            "OnBuild": null,
            "Labels": {
                "org.opencontainers.image.ref.name": "ubuntu",
                "org.opencontainers.image.version": "18.04"
            }
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "685cfe032b48681c9a9ad70fbfae768b83ffbf6b4a7b15eb1053e2a9f193968a",
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "Ports": {},
            "SandboxKey": "/var/run/docker/netns/685cfe032b48",
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "95b9879cba6e6eaa39a689a8c24c148a81eb1e9cb09e3a4f0fa6df5b4abb878d",
            "Gateway": "172.17.0.1",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "172.17.0.2",
            "IPPrefixLen": 16,
            "IPv6Gateway": "",
            "MacAddress": "02:42:ac:11:00:02",
            "Networks": {
                "bridge": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": null,
                    "NetworkID": "87be66351c0e2e5db8e878be5c8cbd76e552ab5fd1608d6d1eeb640a4f099889",
                    "EndpointID": "95b9879cba6e6eaa39a689a8c24c148a81eb1e9cb09e3a4f0fa6df5b4abb878d",
                    "Gateway": "172.17.0.1",
                    "IPAddress": "172.17.0.2",
                    "IPPrefixLen": 16,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "MacAddress": "02:42:ac:11:00:02",
                    "DriverOpts": null
                }
            }
        }
    }
]





docker inspect be6d19673ead
[root@redos redos]# docker inspect be6d19673ead
[
    {
        "Id": "sha256:be6d19673eadd30098f2aa6a3234848e75c3942388ec6ee58fd7a4d63ccfb8d5",
        "RepoTags": [
            "yourname/ubuntu-tmp-file:latest"
        ],
        "RepoDigests": [],
        "Parent": "sha256:5d2df19066aca89df8e5317544a1cb599dc657830184762ff6fdefaaf708db65",
        "Comment": "",
        "Created": "2023-02-27T19:17:34.894277622Z",
        "Container": "5aeebddc380ae2079b55e3c92e6eb95ee47068834284b7225048a8ccc16de9db",
        "ContainerConfig": {
            "Hostname": "5aeebddc380a",
            "Domainname": "",
            "User": "",
            "AttachStdin": true,
            "AttachStdout": true,
            "AttachStderr": true,
            "Tty": true,
            "OpenStdin": true,
            "StdinOnce": true,
            "Env": [
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
            ],
            "Cmd": [
                "/bin/bash"
            ],
            "Image": "ubuntu:18.04",
            "Volumes": null,
            "WorkingDir": "",
            "Entrypoint": null,
            "OnBuild": null,
            "Labels": {
                "org.opencontainers.image.ref.name": "ubuntu",
                "org.opencontainers.image.version": "18.04"
            }
        },
        "DockerVersion": "20.10.10",
        "Author": "",
        "Config": {
            "Hostname": "5aeebddc380a",
            "Domainname": "",
            "User": "",
            "AttachStdin": true,
            "AttachStdout": true,
            "AttachStderr": true,
            "Tty": true,
            "OpenStdin": true,
            "StdinOnce": true,
            "Env": [
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
            ],
            "Cmd": [
                "/bin/bash"
            ],
            "Image": "ubuntu:18.04",
            "Volumes": null,
            "WorkingDir": "",
            "Entrypoint": null,
            "OnBuild": null,
            "Labels": {
                "org.opencontainers.image.ref.name": "ubuntu",
                "org.opencontainers.image.version": "18.04"
            }
        },
        "Architecture": "amd64",
        "Os": "linux",
        "Size": 63146808,
        "VirtualSize": 63146808,
        "GraphDriver": {
            "Data": {
                "LowerDir": "/var/lib/docker/overlay2/a33fde35942647bc7e1a9398eeccbfa4653461c9045a5093be65775f4a5bb6d1/diff",
                "MergedDir": "/var/lib/docker/overlay2/dd4615157696724fd2b6964565326d8cc8e38d4829baa7fe59fa65a71541ae3f/merged",
                "UpperDir": "/var/lib/docker/overlay2/dd4615157696724fd2b6964565326d8cc8e38d4829baa7fe59fa65a71541ae3f/diff",
                "WorkDir": "/var/lib/docker/overlay2/dd4615157696724fd2b6964565326d8cc8e38d4829baa7fe59fa65a71541ae3f/work"
            },
            "Name": "overlay2"
        },
        "RootFS": {
            "Type": "layers",
            "Layers": [
                "sha256:475a54c2a93de61ab1a000184b41b5c5370eef3842486f6c185cd9a001ff1a92",
                "sha256:8b2f148fa65e5dd22866102a0b4ce46bd2e97f7417577f96380616c9885bc9b5"
            ]
        },
        "Metadata": {
            "LastTagTime": "2023-02-27T22:17:34.905281093+03:00"
        }
    }
]


Образ Docker (Docker Image) - это неизменяемый файл, содержащий исходный код, библиотеки, зависимости, инструменты и другие файлы, необходимые для запуска приложения.
Образ - это шаблон, на основе которого создается контейнер, существует отдельно и не может быть изменен. 
При запуске контейнерной среды внутри контейнера создается копия файловой системы (docker образа) для чтения и записи. 
Можно создать неограниченное количество образов Docker из одного шаблона.Каждый раз при изменении начального состояния образа и сохранении существующего состояния создается новый шаблон с дополнительным слоем поверх него.
Таким образом, образы Docker могут состоять из ряда слоев, каждый из которых отличается от предыдущего. Слои образа представляют файлы, доступные только для чтения, поверх которых при создании контейнера добавляется новый слой.

Контейнер Docker (Docker Container) - это виртуализированная среда выполнения, в которой пользователи могут изолировать приложения от хостовой системы. 
Эти контейнеры представляют собой компактные портативные хосты, в которых можно быстро и легко запустить приложение.

Разница:
Говоря о разнице между образами и контейнерами, было бы неверно противопоставлять их друг-другу. Оба элемента тесно связаны между собой и являются основными шестерёнками Docker.
Из определения терминов образ и контейнер выше, легко установить связь между ними: образы могут существовать без контейнеров, тогда как для существования контейнеров необходимо запустить образ. Поэтому контейнеры зависят от изображений и используют их для создания среды выполнения и запуска приложения.
Эти две концепции существуют как важные компоненты (или, скорее, фазы) в процессе запуска контейнера Docker. Наличие рабочего контейнера является конечной «фазой» этого процесса, указывая, что он зависит от предыдущих этапов и компонентов. Именно поэтому образ docker по существу управляют контейнерами и формируют их.

-- YC

[root@redos yandex-cloud]# yc init
Welcome! This command will take you through the configuration process.
Please go to https://oauth.yandex.ru/authorize?response_type=token&client_id=1a6990aa636648e9b2ef855fa7bec2fb in order to obtain OAuth token.

: y0_AgAAAAALvgvzAATuwQAAAADPy4cGyfqeI7nxQ-ufz30CLGqQszcZTqY
You have one cloud available: 'drassadnikov-cloud' (id = b1gorbtfqlahpr5802c4). It is going to be used by default.
Please choose folder to use:
 [1] infra (id = b1gpf2ca5rpkbvk7phms)
 [2] Create a new folder
Please enter your numeric choice: 1
Your current folder has been set to 'infra' (id = b1gpf2ca5rpkbvk7phms).
Do you want to configure a default Compute zone? [Y/n] y
Which zone do you want to use as a profile default?
 [1] ru-central1-a
 [2] ru-central1-b
 [3] ru-central1-c
 [4] Don't set default zone
Please enter your numeric choice: 1
Your profile default Compute zone has been set to 'ru-central1-a'.
There is a new yc version '0.102.0' available. Current version: '0.101.0'.
See release notes at https://cloud.yandex.ru/docs/cli/release-notes
You can install it by running the following command in your shell:
	$ yc components update
-----------------------------

yc compute instance create --name docker-host --zone ru-central1-a --network-interface subnet-name=default-ru-central1-a,nat-ip-version=ipv4 --create-boot-disk image-folder-id=standard-images,image-family=ubuntu-1804-lts,size=15 --ssh-key ~/.ssh/yc.pub

one_to_one_nat:
 address: 51.250.70.85 #пример вывода
 ip_version: IPV4

[redos@redos ~]$ ssh yc-user@51.250.70.85

yc-user@fhm3eh2q3kdvid2nvp3t:~$ docker-machine create --driver generic --generic-ip-address=51.250.70.85 --generic-ssh-user yc-user --generic-ssh-key ~/.ssh/yc docker-host

eval $(docker-machine env docker-host)
------
sudo chmod -R a+xwr /usr/share/rvm
rvm install 2.7

----------------------

yc-user@docker-host:~/.docker/docker-monolith$ docker build -t reddit:latest .
[+] Building 1885.0s (16/16) FINISHED
 => [internal] load build definition from Dockerfile                                                                                                                                                                     0.0s
 => => transferring dockerfile: 438B                                                                                                                                                                                     0.0s
 => [internal] load .dockerignore                                                                                                                                                                                        0.1s
 => => transferring context: 2B                                                                                                                                                                                          0.0s
 => [internal] load metadata for docker.io/library/ubuntu:18.04                                                                                                                                                          1.0s
 => [auth] library/ubuntu:pull token for registry-1.docker.io                                                                                                                                                            0.0s
 => [ 1/10] FROM docker.io/library/ubuntu:18.04@sha256:a3765b4d74747b5e9bdd03205b3fbc4fa19a02781c185f97f24c8f4f84ed7bbf                                                                                                  0.0s
 => [internal] load build context                                                                                                                                                                                        0.0s
 => => transferring context: 89B                                                                                                                                                                                         0.0s
 => CACHED [ 2/10] RUN apt-get update                                                                                                                                                                                    0.0s
 => CACHED [ 3/10] RUN apt-get install -y mongodb-server ruby-full ruby-dev build-essential git                                                                                                                          0.0s
 => [ 4/10] RUN gem install bundler -v 2.2.0                                                                                                                                                                             6.4s
 => [ 5/10] RUN git clone -b monolith https://github.com/express42/reddit.git                                                                                                                                            4.1s
 => [ 6/10] COPY mongod.conf /etc/mongod.conf                                                                                                                                                                            0.3s
 => [ 7/10] COPY db_config /reddit/db_config                                                                                                                                                                             0.2s
 => [ 8/10] COPY start.sh /start.sh                                                                                                                                                                                      0.2s
 => [ 9/10] RUN cd /reddit && rm Gemfile.lock && bundle install                                                                                                                                                       1758.7s
 => [10/10] RUN chmod 0777 /start.sh                                                                                                                                                                                     0.8s
 => exporting to image                                                                                                                                                                                                 113.4s
 => => exporting layers                                                                                                                                                                                                113.3s
 => => writing image sha256:211fd22e68aa5138215cb5fe16d3657bc9cd9348f9a977d02cd56cee9564a204                                                                                                                             0.0s
 => => naming to docker.io/library/reddit:latest                                                          
 
 yc-user@docker-host:~/.docker/docker-monolith$ docker images -a
REPOSITORY      TAG       IMAGE ID       CREATED         SIZE
reddit          latest    211fd22e68aa   2 minutes ago   655MB
hello-world     latest    feb5d9fea6a5   17 months ago   13.3kB
tehbilly/htop   latest    4acd2b4de755   4 years ago     6.91MB


yc-user@docker-host:~/.docker/docker-monolith$  docker-machine ls
NAME          ACTIVE   DRIVER    STATE     URL                       
docker-host   -        generic   Running   tcp://51.250.70.85:2376   

http://51.250.70.85:9292

----------------
yc-user@docker-host:~/.docker/docker-monolith$ docker login
Login with your Docker ID to push and pull images from Docker Hub. If you don't have a Docker ID, head over to https://hub.docker.com to create one.
Username: drassadnikov
Password:
WARNING! Your password will be stored unencrypted in /home/yc-user/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store

yc-user@docker-host:~/.docker/docker-monolith$ docker tag reddit:latest drassadnikov/otus-reddit:1.0
yc-user@docker-host:~/.docker/docker-monolith$ docker push drassadnikov/otus-reddit:1.0
The push refers to repository [docker.io/drassadnikov/otus-reddit]
405495d2cae3: Pushed
fe1cd69cf571: Pushed
a4d27a0978be: Pushed
ba93613f141b: Pushed
a60953a03908: Pushed
8a8ad30bbc08: Pushed
e4b0b8a15e70: Pushed
12520459f272: Pushed
6049de7f10f6: Pushed
475a54c2a93d: Mounted from library/ubuntu
1.0: digest: sha256:c1cddd131bc9076a7c445aec2df0f1771a0b2a97d9c2adcbb811c3e80de5347d size: 2414t:1.0

[root@redos ~]# docker run --name reddit -d -p 9292:9292 drassadnikov/otus-reddit:1.0
Unable to find image 'drassadnikov/otus-reddit:1.0' locally
1.0: Pulling from drassadnikov/otus-reddit
72d9f18d70f3: Pull complete 
15db214253de: Pull complete 
64c274add42b: Pull complete 
e22abc689d77: Pull complete 
6888f9c81042: Pull complete 
7bc8b18de448: Pull complete 
48f5713f65fd: Pull complete 
6c1f7b3c0f44: Pull complete 
ef5bfaca190f: Pull complete 
2ce17cac99ba: Pull complete 
Digest: sha256:c1cddd131bc9076a7c445aec2df0f1771a0b2a97d9c2adcbb811c3e80de5347d
Status: Downloaded newer image for drassadnikov/otus-reddit:1.0
61b7b819ff432695edb097228a5d6f22e4326574460786c143849c2cc1d21394


docker logs reddit -f
docker exec -it reddit bash
ps aux
killall5 1

---------------

$ docker-machine rm docker-host
$ yc compute instance delete docker-host
